There are three different kinds of icmp messages, namely "ICMP Query Messages", "ICMP Error Messages" and "Non-QueryError ICMP Messages". ICMP Query messages are characterized by an identifier field in the ICMP header which is also called "Query Identifier" or "Query Id". Such a Query Id is used for creating a nat mapping. The internal query id gets replaces by an external id which the nat device has to remember to process the nat session later on. An ICMP Error message does not provide such a "Query Id". It provides signaling for IP and is characterized by the fact that it contains the datagram which triggered the ICMP error message in the first place. A nat mapping is only possible by inspecing the contained datagram and create a nat mapping on this information. I guess the ip addresses of the contained datagram are getting exchanged (external <-> internal) and this replacement is saved by the nat device which therefore assigns it a session. As the name suggests "Non-QueryError ICMP Messages" is a separated, third class of its own and according to the rfc chapter 8, there is no official way of handling it a nat environment: REQ-11: A NAT MAY drop or appropriately handle Non-QueryErrorÂ´ICMP messages. The semantics of Non-QueryError ICMP messages is defined in Section 2.
		Possible attacks:
			* Smurf attack: A DDoS attack where a large number if ICMP packets with the victim's spoofed ip address as source is broadcasted to a network. If the network contains a large number of devices which answer the ICMP packet's source address, the victim gets flooded with traffic which can slow down the victim's computer. Mitigation: Configure individual hosts and routers to not respond to ICMP requests or broadcasts. Configure routers to not forward packets directed to broadcast addresses
			* Ping of death: An attacker sends an ICMP echo request packet that's larger than the maximum IP packet size. Since the received ICMP echo request packet is larger than the normal IP packet size, it's fragmented. The target can't reassemble the packets, so the OS crashes or reboots. Mitigation: Selectively block fragmented pings, allowing actual ping traffic to pass through unhindered.
			* ICMP flood attack: A broadcast storm of pings overwhelms the target system so it can't respond to legitimate traffic. Mitigation: Limiting the size of ping requests as well as the rate at which they can be accepted.